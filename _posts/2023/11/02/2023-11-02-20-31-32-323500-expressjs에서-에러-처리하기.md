---
layout: post
title: "[javascript] Express.js에서 에러 처리하기"
description: " "
date: 2023-11-02
tags: [javascript]
comments: true
share: true
---

Express.js는 Node.js를 위한 강력한 웹 프레임워크입니다. 서버 개발자들에게 많은 유연성을 제공하며, 빠른 개발을 할 수 있도록 도와줍니다. 그러나 서버에서 발생할 수 있는 에러를 적절히 처리하는 것은 매우 중요합니다. 이번 블로그 포스트에서는 Express.js에서 에러 처리를 하는 방법을 알아보겠습니다.

## 에러 처리 미들웨어

Express.js에서 에러 처리를 위해 사용되는 주요 개념은 에러 처리 미들웨어입니다. 미들웨어는 요청과 응답 사이에서 실행되는 함수입니다. 이 함수를 통해 에러를 캐치하고 적절히 처리할 수 있습니다.

```javascript
app.use((err, req, res, next) => {
  // 에러 처리 로직 작성
});
```

에러 처리 미들웨어 함수는 네 개의 매개변수를 받습니다. 첫 번째 매개변수는 에러 객체이며, 이 객체를 통해 에러의 세부 정보에 접근할 수 있습니다. 두 번째 매개변수는 요청 객체입니다. 세 번째 매개변수는 응답 객체이며, 이를 사용하여 클라이언트에게 적절한 응답을 보낼 수 있습니다. 네 번째 매개변수는 다음 미들웨어로 제어를 전달하는데 사용됩니다.

## 기본 에러 처리

Express.js는 기본적으로 일반적인 에러를 자동으로 처리하는 기능을 제공합니다. 예를 들어, 라우트 핸들러에서 throw 키워드로 에러를 던진 경우, Express.js는 자동으로 에러 처리 미들웨어를 호출하여 에러를 처리합니다.

```javascript
app.get('/example', (req, res, next) => {
  if (error) {
    next(new Error("에러 발생!"));
  } else {
    // 정상적인 로직 수행
  }
});
```

위의 예제에서 `/example` 경로에 대한 요청을 처리하는 라우트 핸들러에서 에러가 발생하면, 에러 처리 미들웨어가 호출됩니다. 이때, `next` 함수에 `new Error("에러 발생!")`를 전달해야 합니다.

## 커스텀 에러 처리

기본 에러 처리 외에도, Express.js에서는 커스텀 에러 처리 로직을 작성할 수 있습니다. 이를 통해 더 세밀한 에러 처리를 구현할 수 있습니다.

```javascript
app.use((err, req, res, next) => {
  // 에러 처리 로직 작성
  res.status(500).json({ error: err.message });
});
```

위의 예제에서는 `res` 객체를 사용하여 응답을 보내는 대신, JSON 형식으로 에러 메시지를 클라이언트에게 전달합니다. 또한 `res.status(500)` 메소드를 통해 응답 상태 코드를 설정할 수 있습니다.

## 에러 페이지 보여주기

일반적인 웹 애플리케이션에서, 에러가 발생했을 때 사용자에게 친화적인 에러 페이지를 보여주는 것이 중요합니다. Express.js에서는 이를 간단하게 처리할 수 있는 기능을 제공합니다.

```javascript
app.use((err, req, res, next) => {
  // 에러 처리 로직 작성
  res.render('error', { message: err.message });
});
```

위의 예제에서는 `res.render` 메소드를 사용하여 에러 페이지를 렌더링하고, 에러 메시지를 템플릿에 전달합니다. 이후 해당 템플릿을 클라이언트에게 보내 에러 페이지를 표시할 수 있습니다.

## 마치며

Express.js에서 에러 처리는 실무에서 자주 마주치는 문제입니다. 이번 블로그 포스트에서는 Express.js에서 에러 처리를 하는 방법에 대해 알아보았습니다. 이를 참고하여 안정적인 웹 애플리케이션을 개발하는 데 도움이 되길 바랍니다.

## 참고 자료
- [Express.js 공식 문서](https://expressjs.com/)
- [Express.js 에러 처리 미들웨어 관련 스택 오버플로우 질문](https://stackoverflow.com/questions/55437973/handling-errors-in-express-js)